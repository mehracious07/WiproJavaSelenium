package JDBC_Rev;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;

public class ParametrizedQueryUpdate {
	private static final String url="jdbc:mysql://localhost:3306/room";
	private static final String user_name="root";
	private static final String pass="sanjaymehra@123";
	
	public static void main(String[] args) throws ClassNotFoundException, SQLException {
		  // Load MySQL JDBC driver
        Class.forName("com.mysql.cj.jdbc.Driver");

        // Establish connection
        Connection cn = DriverManager.getConnection(url, user_name, pass);
        System.out.println("Connection established");

        
        String insertQuery = "INSERT INTO friends (ID, NAME, CITY) VALUES (?, ?, ?)";
        PreparedStatement insertSt = cn.prepareStatement(insertQuery);
        insertSt.setInt(1, 4);         
        insertSt.setString(2, "Mohit"); 
        insertSt.setString(3, "Jaipur"); 

        int rowsInserted = insertSt.executeUpdate();
        System.out.println(rowsInserted + " row(s) inserted.");

  
        String updateQuery = "UPDATE friends SET CITY = ? WHERE ID = ? AND NAME = ?";
        PreparedStatement updateSt = cn.prepareStatement(updateQuery);
        updateSt.setString(1, "Mumbai"); 
        updateSt.setInt(2, 1);           
        updateSt.setString(3, "Aman");

        int rowsUpdated = updateSt.executeUpdate();
        System.out.println(rowsUpdated + " row(s) updated.");
        
       

        // Close statements and connection
        insertSt.close();
        updateSt.close();
        cn.close();

	}

}
