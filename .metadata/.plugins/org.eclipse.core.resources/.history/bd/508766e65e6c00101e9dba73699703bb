package JDBC_Rev;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;

public class ParametrizedQueryUpdate {

	public static void main(String[] args) {
		  // Load MySQL JDBC driver
        Class.forName("com.mysql.cj.jdbc.Driver");

        // Establish connection
        Connection cn = DriverManager.getConnection(url, user_name, pass);
        System.out.println("Connection established");

        // ===================== INSERT DATA ======================
        String insertQuery = "INSERT INTO friends (ID, NAME, CITY) VALUES (?, ?, ?)";
        PreparedStatement insertSt = cn.prepareStatement(insertQuery);
        insertSt.setInt(1, 3);         
        insertSt.setString(2, "Ravi"); 
        insertSt.setString(3, "Delhi"); 

        int rowsInserted = insertSt.executeUpdate();
        System.out.println(rowsInserted + " row(s) inserted.");

  
        String updateQuery = "UPDATE friends SET CITY = ? WHERE ID = ? AND NAME = ?";
        PreparedStatement updateSt = cn.prepareStatement(updateQuery);
        updateSt.setString(1, "Mumbai"); // New city
        updateSt.setInt(2, 1);           // ID
        updateSt.setString(3, "Aman");   // NAME

        int rowsUpdated = updateSt.executeUpdate();
        System.out.println(rowsUpdated + " row(s) updated.");

        // Close statements and connection
        insertSt.close();
        updateSt.close();
        cn.close();

	}

}
