package JDBC_Rev;

import java.sql.Statement;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class CRUD {
	private static final String url="jdbc:mysql://localhost:3306/companydb";
	private static final String user_name="root";
	private static final String pass="sanjaymehra@123";
	
	public static void main(String[] args) throws ClassNotFoundException, SQLException {
		
		//load Driver
		Class.forName("com.mysql.cj.jdbc.Driver");
		Connection cn = DriverManager.getConnection(url,user_name,pass);
		System.out.println("Connection established");
		
		
//		String createQuery = "CREATE TABLE IF NOT EXISTS employees (" +
//                "id INT PRIMARY KEY, " +
//                "name VARCHAR(50), " +
//                "department VARCHAR(50), " +
//                "salary DOUBLE)";
//		
//		PreparedStatement st = cn.prepareStatement(createQuery);
//		st.executeUpdate();
//		System.out.println("The table is created ");
		
//		String insertQuery="INSERT INTO Employees(id,name,department,salary) VALUES (?,?,?,?) ";
//		PreparedStatement st1=cn.prepareStatement(insertQuery);
//		
//		st1.setInt(1, 101);
//		st1.setString(2, "Alice");
//		st1.setString(3, "HR");
//		st1.setInt(4, 50000);
//		st1.executeUpdate();
//		
//		 st1.setInt(1, 102);
//	     st1.setString(2, "Bob");
//	     st1.setString(3, "IT");
//	     st1.setDouble(4, 65000);
//	     st1.executeUpdate();
//
//	     st1.setInt(1, 103);
//	     st1.setString(2, "Charlie");
//	     st1.setString(3, "Sales");
//	     st1.setDouble(4, 60000);
//	     st1.executeUpdate();
	        
//	     String selectQuery="SELECT * FROM employees;";
//	     PreparedStatement st2=cn.prepareStatement(selectQuery);
//	     ResultSet rs=st2.executeQuery();
//	     
//	     while(rs.next()) {
//	    	 System.out.println(rs.getString("id"));
//	    	 System.out.println(rs.getString("name"));
//	    	 System.out.println(rs.getString("department"));
//	    	 System.out.println(rs.getString("salary"));
//	     }
		
		
//		String conditionalSelectQuery="SELECT *FROM Employees WHERE id=?";
//		PreparedStatement st3 = cn.prepareStatement(conditionalSelectQuery);
//		st3.setInt(1, 101);
//		ResultSet rs2=st3.executeQuery();
//		   while(rs2.next()) {
//		    	 System.out.println(rs2.getInt("id"));
//		    	 System.out.println(rs2.getString("name"));
//		    	 System.out.println(rs2.getString("department"));
//		    	 System.out.println(rs2.getString("salary"));
//		     }
		
		
		String UpdateQuery="UPDATE employees SET salary = ? WHERE id = ?;";
		PreparedStatement st4=cn.prepareStatement(UpdateQuery);
		st4.setInt(1,70000);
		st4.setInt(2,102);
		st4.executeUpdate();
		
		

	}

}
